(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{194:function(t,e,a){},211:function(t,e,a){},233:function(t,e,a){},275:function(t,e,a){t.exports=a(364)},281:function(t,e,a){},282:function(t,e,a){},283:function(t,e,a){},284:function(t,e,a){},285:function(t,e,a){},286:function(t,e,a){},299:function(t,e,a){},300:function(t,e,a){},301:function(t,e,a){},302:function(t,e,a){},347:function(t,e){},350:function(t,e,a){},351:function(t,e,a){},352:function(t,e,a){},353:function(t,e,a){},354:function(t,e){},356:function(t,e,a){},357:function(t,e,a){},358:function(t,e,a){},359:function(t,e,a){},360:function(t,e,a){},361:function(t,e,a){},362:function(t,e,a){},363:function(t,e,a){},364:function(t,e,a){"use strict";a.r(e);var n=a(0),o=a.n(n),s=a(54),r=a.n(s),i=a(390),l=(a(211),a(280),a(31)),c=a.n(l),u=a(48),p=a(23),h=a(24),d=a(26),m=a(25),g=a(27),f=a(395),v=a(238),E=a(392),b=a(397),w=(a(281),function(t){return o.a.createElement(n.Fragment,null,o.a.createElement("header",{className:"main-header"},t.header),t.mobileNav,o.a.createElement("main",{className:"content"},t.children))}),k=(a(282),function(t){return o.a.createElement("div",{className:["backdrop",t.open?"open":""].join(" "),onClick:t.onClick})}),y=(a(283),function(t){return o.a.createElement("div",{className:"toolbar",style:{position:"relative",zIndex:"1"}},t.children)}),S=a(372),C=(a(284),function(t){return o.a.createElement("button",{className:"mobile-toggle",onClick:t.onOpen},o.a.createElement("span",{className:"mobile-toggle__bar"}),o.a.createElement("span",{className:"mobile-toggle__bar"}),o.a.createElement("span",{className:"mobile-toggle__bar"}))}),P=(a(285),function(t){return o.a.createElement("h1",{className:"logo"},"SpotShare")}),_=a(51),j=a(386),O=(a(286),[{id:"feed",text:"Feed",link:"/",auth:!0},{id:"my-profile",text:"Profile",link:"/posts",auth:!0},{id:"my-bucket",text:"Bucket",link:"/my-bucket",auth:!0},{id:"my-map",text:"Map",link:"/my-map",auth:!0},{id:"rankings",text:"Rank",link:"/rankings",auth:!0},{id:"login",text:"Login",link:"/",auth:!1},{id:"signup",text:"Signup",link:"/signup",auth:!1}]),L=function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).state=a.props.state,a.getUserName=function(){var t=localStorage.getItem("userId"),e=localStorage.getItem("token");fetch("https://photography-spot-share.herokuapp.com/auth/user/"+t,{method:"GET",headers:{Authorization:"Bearer "+e}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Fetching user name failed!");return t.json()}).then(function(t){a.setState({name:t.userObj.name})}).catch(function(t){console.log(t)})},a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){var t=localStorage.getItem("userId"),e=localStorage.getItem("token");t&&e&&this.setState({loaded:!0,name:this.getUserName()})}},{key:"render",value:function(){var t=this;return this.props.isAuth&&!this.state&&window.location.reload(),[].concat(Object(_.a)(O.filter(function(e){return e.auth===t.props.isAuth}).map(function(e){return o.a.createElement("li",{key:e.id,className:["navigation-item",t.props.mobile?"mobile":""].join(" ")},o.a.createElement(S.a,{to:e.link,exact:!0,onClick:t.props.onChoose},e.text))})),[this.props.isAuth&&this.state&&this.state.name&&o.a.createElement("li",{className:"navigation-item",key:"logout"},o.a.createElement(j.a,null,o.a.createElement(j.a.Toggle,{variant:"Warning",id:"dropdown-basic"},"Hello ",this.state.name,"!"),o.a.createElement(j.a.Menu,null,o.a.createElement(j.a.Item,{style:{color:"green"},onClick:this.props.onLogout},"Logout"))))])}}]),e}(n.Component),H=(a(299),function(t){function e(){return Object(p.a)(this,e),Object(d.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(g.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){return o.a.createElement("nav",{className:"main-nav"},o.a.createElement(C,{onOpen:this.props.onOpenMobileNav}),o.a.createElement("div",{className:"main-nav__logo"},o.a.createElement(S.a,{to:"/"},o.a.createElement(P,null))),o.a.createElement("div",{className:"spacer"}),o.a.createElement("ul",{className:"main-nav__items"},o.a.createElement(L,{isAuth:this.props.isAuth,onLogout:this.props.onLogout,isLoading:this.props.isLoading,userId:this.props.userId,token:this.props.token,state:this.props.state,name:this.props.name})))}}]),e}(n.Component)),I=(a(300),function(t){return o.a.createElement("nav",{className:["mobile-nav",t.open?"open":""].join(" ")},o.a.createElement("ul",{className:["mobile-nav__items",t.mobile?"mobile":""].join(" ")},o.a.createElement(L,{mobile:!0,onChoose:t.onChooseItem,isAuth:t.isAuth,onLogout:t.onLogout})))}),x=a(202),N=(a(301),a(243)),F=function(t){return t.link?o.a.createElement(x.a,{to:t.link},o.a.createElement(N.a,{variant:"outline-dark",className:["button","button--".concat(t.design),"button--".concat(t.mode),"button--".concat(t.colorChange)].join(" ")},t.children)):o.a.createElement(N.a,{variant:"outline-dark",className:["button","button--".concat(t.design),"button--".concat(t.mode),"button--".concat(t.colorChange)].join(" "),onClick:t.onClick,disabled:t.disabled||t.loading,type:t.type},t.loading?"Loading...":t.children)},A=(a(302),a(385)),T=function(t){var e=o.a.useState(!1)[1];return o.a.createElement(o.a.Fragment,null,o.a.createElement(A.a,{show:!0,onHide:function(){return e(!0)}},o.a.createElement(A.a.Header,null,o.a.createElement(A.a.Title,null,t.title)),o.a.createElement(A.a.Body,null,o.a.createElement("div",{className:"modal__content"},t.children)),o.a.createElement(A.a.Footer,null,o.a.createElement(F,{design:"danger",mode:"flat",onClick:t.onCancelModal},"Cancel"),o.a.createElement(F,{mode:"raised",onClick:t.onAcceptModal,disabled:!t.acceptEnabled,loading:t.isLoading},"Accept"))))},B=function(t){return o.a.createElement(n.Fragment,null,t.error&&o.a.createElement(k,{onClick:t.onHandle}),t.error&&o.a.createElement(T,{title:"An Error Occurred",onCancelModal:t.onHandle,onAcceptModal:t.onHandle,acceptEnabled:!0},o.a.createElement("p",null,t.error.message)))},R=a(17),z=a(63),V=a.n(z),D=(a(350),a(373)),M=a(374),U=(a(351),function(t){return o.a.createElement("div",{className:"loader"},o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null))}),J=function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).state={bucketNum:0,postInBucket:!1,btnTitle:"Bucket!",loading:"true"},a.bucketHandler=function(){a.state.postInBucket?fetch("https://photography-spot-share.herokuapp.com/feed/bucket-num/"+a.props.id,{method:"PATCH",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({newBucketNum:a.state.bucketNum-1})}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Can't update bucket number!");return t.json()}).then(function(t){return a.setState({postInBucket:!1,btnTitle:"Bucket!"}),V()("https://photography-spot-share.herokuapp.com").on("bucket",function(t){"update"===t.action&&a.updateBucketNum(t.newBucketNum)}),a.props.offBucket()}).catch(a.catchError):fetch("https://photography-spot-share.herokuapp.com/feed/bucket-num/"+a.props.id,{method:"PATCH",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({newBucketNum:a.state.bucketNum+1})}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Can't update bucket number!");return t.json()}).then(function(t){return a.setState({postInBucket:!0,btnTitle:"Unbucket!"}),a.props.onBucket()}).catch(a.catchError)},a.updateBucketNum=function(t){a.setState({btnTitle:a.state.btnTitle.split("(")[0]+"("+t+")"}),a.render()},a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){var t=this;fetch("https://photography-spot-share.herokuapp.com/feed/bucket-num/"+this.props.id,{headers:{Authorization:"Bearer "+this.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Fetching bucket number failed!");return t.json()}).then(function(e){return t.setState({bucketNum:e.bucketNum}),e}).then(function(e){t.props.userBucket.includes(t.props.id)?t.setState({postInBucket:!0,btnTitle:"Unbucket!("+e.bucketNum+")"}):t.setState({postInBucket:!1,btnTitle:"Bucket!("+e.bucketNum+")"}),t.setState({loading:"false"})}).catch(function(t){console.log(t)})}},{key:"render",value:function(){return"true"===this.state.loading?o.a.createElement(U,null):this.props.author._id===localStorage.getItem("userId")?o.a.createElement("article",{className:"post"},o.a.createElement("header",{className:"post__header"},o.a.createElement("h1",{className:"post__title text-center"},this.props.title),o.a.createElement("hr",null),o.a.createElement("h3",{className:"post__infos"},"Posted by ",this.props.author.name," on ",this.props.date," ||  Shot at ",this.props.location.text," on ",this.props.taken_date)),o.a.createElement("div",{className:"post__image"},o.a.createElement("img",{className:"post_img",src:"https://photography-spot-share.herokuapp.com/"+this.props.image,alt:this.props.title})),o.a.createElement(D.a,{className:"text-center buttonbar",style:{width:"30rem"}},o.a.createElement(M.a,{className:"text-center"},o.a.createElement("div",{className:"button-pad pull-right"},o.a.createElement(F,{mode:"flat",link:this.props.id},"View")),o.a.createElement("div",{className:"button-pad"},o.a.createElement(F,{mode:"flat",onClick:this.props.onStartEdit},"Edit")),o.a.createElement("div",{className:"button-pad"},o.a.createElement(F,{mode:"flat",onClick:this.props.startReview},"Review")),o.a.createElement("div",{className:"button-pad"},o.a.createElement(F,{mode:"flat",design:"danger",colorChange:"colorChange",onClick:this.bucketHandler},this.state.btnTitle)),o.a.createElement("div",{className:"button-pad"},o.a.createElement(F,{mode:"flat",design:"danger",onClick:this.props.onDelete},"Delete"))))):o.a.createElement("article",{className:"post"},o.a.createElement("header",{className:"post__header"},o.a.createElement("h1",{className:"post__title text-center"},this.props.title),o.a.createElement("hr",null),o.a.createElement("h3",{className:"post__infos"},"Posted by ",this.props.author.name," on ",this.props.date," ||  Shot at ",this.props.location.text," on ",this.props.taken_date)),o.a.createElement("div",{className:"post__image"},o.a.createElement("img",{className:"post_img",src:"https://photography-spot-share.herokuapp.com/"+this.props.image,alt:this.props.title})),o.a.createElement(D.a,{className:"text-center buttonbar",style:{width:"20rem"}},o.a.createElement(M.a,{className:"text-center"},o.a.createElement("div",{className:"button-pad pull-right"},o.a.createElement(F,{mode:"flat",link:this.props.id},"View")),o.a.createElement("div",{className:"button-pad"},o.a.createElement(F,{mode:"flat",onClick:this.props.startReview},"Review")),o.a.createElement("div",{className:"button-pad"},o.a.createElement(F,{mode:"flat",design:"danger",colorChange:"colorChange",onClick:this.bucketHandler},this.state.btnTitle)))))}}]),e}(n.Component),q=a(70),W=a(384),G=(a(233),function(t){return o.a.createElement("div",{className:"input"},t.label&&o.a.createElement(W.a.Label,{htmlFor:t.id},t.label),"input"===t.control&&o.a.createElement(W.a.Control,{className:[t.valid?"valid":"invalid",t.touched?"touched":"untouched"].join(" "),type:t.type,id:t.id,required:t.required,value:t.value,placeholder:t.placeholder,onChange:function(e){return t.onChange(t.id,e.target.value,e.target.files)},onBlur:t.onBlur}),"textarea"===t.control&&o.a.createElement("textarea",{className:[t.valid?"valid":"invalid",t.touched?"touched":"untouched"].join(" "),id:t.id,rows:t.rows,required:t.required,value:t.value,onChange:function(e){return t.onChange(t.id,e.target.value)},onBlur:t.onBlur}))}),Q=function(t){return o.a.createElement("div",{className:"input"},o.a.createElement(W.a.Label,{htmlFor:t.id},t.label),o.a.createElement(W.a.Control,{className:[t.valid?"valid":"invalid",t.touched?"touched":"untouched"].join(" "),type:"file",id:t.id,onChange:function(e){return t.onChange(t.id,e.target.value,e.target.files)},onBlur:t.onBlur}))},X=(a(352),function(t){return o.a.createElement("div",{className:"image",style:{backgroundImage:"url('".concat(t.imageUrl,"')"),backgroundSize:t.contain?"contain":"cover",backgroundPosition:t.left?"left":"center"}})}),Y=function(t){return""!==t.trim()},Z=function(t){return function(e){var a=!0;return t.min&&(a=a&&e.trim().length>=t.min),t.max&&(a=a&&e.trim().length<=t.max),a}},$=function(t){return/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(t)},K=function(t){var e=new FileReader,a=new Promise(function(t,a){e.onload=function(e){return t(e.target.result)},e.onerror=function(t){return a(t)}});return e.readAsDataURL(t),a},tt=a(245),et=(a(353),a(192),a(193),a(80)),at=a(383),nt=a(387),ot=a(247),st="pk.eyJ1IjoieTI2MmhhbiIsImEiOiJjanozamU2bmkwMzJ5M2d0Nm84ZW5meHhzIn0.L1kW4Q7vNyX0fCJJEYI5PA",rt=function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(s)))).state={viewport:{latitude:a.props.value.center[1],longitude:a.props.value.center[0],zoom:8},searchResultLayer:null},a.mapRef=o.a.createRef(),a.handleViewportChange=function(t){a.setState({viewport:Object(R.a)({},a.state.viewport,t)})},a.handleGeocoderViewportChange=function(t){return a.handleViewportChange(Object(R.a)({},t,{transitionDuration:1e3}))},a.handleOnResult=function(t){a.setState({searchResultLayer:new at.a({id:"search-result",data:t.result.geometry,getFillColor:[255,0,0,128],getRadius:1e3,pointRadiusMinPixels:10,pointRadiusMaxPixels:10})}),a.props.onChange(t.result)},a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this,e=this.state,a=e.viewport,n=e.searchResultLayer;return o.a.createElement("div",{style:{height:"100%"}},o.a.createElement(et.c,Object.assign({ref:this.mapRef},a,{width:this.props.width,height:this.props.height,onViewportChange:this.handleViewportChange,mapboxApiAccessToken:st,mapStyle:"mapbox://styles/y262han/cjz3kx9a80fby1cr3d8oydttt"}),o.a.createElement(ot.a,{mapRef:this.mapRef,onResult:this.handleOnResult,onViewportChange:this.handleGeocoderViewportChange,mapboxApiAccessToken:st,position:"top-left",inputValue:this.props.inputval,onChange:function(e){return t.props.onChange(e.target.value)}}),o.a.createElement(nt.a,Object.assign({},a,{layers:[n]}))))}}]),e}(n.Component),it=a(252),lt=a.n(it),ct=function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).state={rating:a.props.value},a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"onStarClick",value:function(t,e,a){this.setState({rating:t}),this.props.onChange(t)}},{key:"render",value:function(){var t=this.state.rating;return o.a.createElement("div",null,o.a.createElement("p",null,this.props.label,": ",t),o.a.createElement("div",{style:{fontSize:"2rem"}},o.a.createElement(lt.a,{name:"rate1",starCount:5,value:this.state.rating,onStarClick:this.onStarClick.bind(this)})))}}]),e}(o.a.Component),ut={title:{value:"",valid:!1,touched:!1,validators:[Y,Z({min:5})]},image:{value:"",valid:!1,touched:!1,validators:[Y]},content:{value:"",valid:!1,touched:!1,validators:[Y,Z({min:5})]},taken_date:{value:"",valid:!1,touched:!1,validators:[Y]},location:{value:{id:"",type:"",place_type:[],relevance:0,properties:{},text:"",place_name:"",center:[-75.69,45.421],geometry:{},context:[]},valid:!1,touched:!1,validators:[Y]},ISO:{value:"",valid:!1,touched:!1,validators:[Y]},shutter_speed:{value:"",valid:!1,touched:!1,validators:[Y]},aperture:{value:"",valid:!1,touched:!1,validators:[Y]},camera:{value:"",valid:!1,touched:!1,validators:[Y]},lens:{value:"",valid:!1,touched:!1,validators:[Y]},equipment:{value:"",valid:!1,touched:!1,validators:[Y]},edit_soft:{value:"",valid:!1,touched:!1,validators:[Y]},user_rate:{value:3,valid:!1,touched:!1,validators:[Y]}},pt=function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).state={postForm:ut,formIsValid:!1,imagePreview:null,loading:"true"},a.postInputChangeHandler=function(t,e,n){n&&K(n[0]).then(function(t){a.setState({imagePreview:t})}).catch(function(t){a.setState({imagePreview:null})}),a.setState(function(a){var o=!0,s=!0,r=!1,i=void 0;try{for(var l,c=a.postForm[t].validators[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var u=l.value;o=o&&u(e)}}catch(m){r=!0,i=m}finally{try{s||null==c.return||c.return()}finally{if(r)throw i}}var p=Object(R.a)({},a.postForm,Object(q.a)({},t,Object(R.a)({},a.postForm[t],{valid:o,value:n?n[0]:e}))),h=!0;for(var d in p)h=h&&p[d].valid;return{postForm:p,formIsValid:h}})},a.postLocationChangeHandler=function(t){a.setState(function(e){return{postForm:Object(R.a)({},e.postForm,{location:Object(R.a)({},e.postForm.location,{valid:!0,value:t})}),formIsValid:!0}})},a.postRatingChangeHandler=function(t){a.setState(function(e){return{postForm:Object(R.a)({},e.postForm,{user_rate:Object(R.a)({},e.postForm.user_rate,{valid:!0,value:t})}),formIsValid:!0}})},a.inputBlurHandler=function(t){a.setState(function(e){return{postForm:Object(R.a)({},e.postForm,Object(q.a)({},t,Object(R.a)({},e.postForm[t],{touched:!0})))}})},a.cancelPostChangeHandler=function(){a.setState({postForm:ut,formIsValid:!1,loading:"true"}),a.props.onCancelEdit()},a.acceptPostChangeHandler=function(){var t={title:a.state.postForm.title.value,image:a.state.postForm.image.value,content:a.state.postForm.content.value,taken_date:a.state.postForm.taken_date.value,location:a.state.postForm.location.value,ISO:a.state.postForm.ISO.value,shutter_speed:a.state.postForm.shutter_speed.value,aperture:a.state.postForm.aperture.value,camera:a.state.postForm.camera.value,lens:a.state.postForm.lens.value,equipment:a.state.postForm.equipment.value,edit_soft:a.state.postForm.edit_soft.value,user_rate:a.state.postForm.user_rate.value};a.props.onFinishEdit(t),a.setState({postForm:ut,formIsValid:!1,imagePreview:null,loading:"true"})},a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"componentDidUpdate",value:function(t,e){if(this.props.editing&&t.editing!==this.props.editing&&t.selectedPost!==this.props.selectedPost){var a={title:Object(R.a)({},e.postForm.title,{value:this.props.selectedPost.title,valid:!0}),image:Object(R.a)({},e.postForm.image,{value:this.props.selectedPost.imagePath,valid:!0}),content:Object(R.a)({},e.postForm.content,{value:this.props.selectedPost.content,valid:!0}),taken_date:Object(R.a)({},e.postForm.taken_date,{value:this.props.selectedPost.taken_date,valid:!0}),location:Object(R.a)({},e.postForm.location,{value:this.props.selectedPost.location,valid:!0}),ISO:Object(R.a)({},e.postForm.ISO,{value:this.props.selectedPost.ISO,valid:!0}),shutter_speed:Object(R.a)({},e.postForm.shutter_speed,{value:this.props.selectedPost.shutter_speed,valid:!0}),aperture:Object(R.a)({},e.postForm.aperture,{value:this.props.selectedPost.aperture,valid:!0}),camera:Object(R.a)({},e.postForm.camera,{value:this.props.selectedPost.camera,valid:!0}),lens:Object(R.a)({},e.postForm.lens,{value:this.props.selectedPost.lens,valid:!0}),equipment:Object(R.a)({},e.postForm.equipment,{value:this.props.selectedPost.equipment,valid:!0}),edit_soft:Object(R.a)({},e.postForm.edit_soft,{value:this.props.selectedPost.edit_soft,valid:!0}),user_rate:Object(R.a)({},e.postForm.user_rate,{value:this.props.selectedPost.user_rate,valid:!0})};this.setState({postForm:a,formIsValid:!0,loading:"false"})}}},{key:"render",value:function(){return this.props.editing?"true"!==this.state.loading||this.props.isNewPost?this.props.editing?o.a.createElement(n.Fragment,null,o.a.createElement(k,{onClick:this.cancelPostChangeHandler}),o.a.createElement(T,{title:"New Post",acceptEnabled:this.state.formIsValid,onCancelModal:this.cancelPostChangeHandler,onAcceptModal:this.acceptPostChangeHandler,isLoading:this.props.loading},o.a.createElement(W.a,null,o.a.createElement("div",{className:"input-padding"},o.a.createElement(G,{id:"title",label:"Title",control:"input",onChange:this.postInputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"title"),valid:this.state.postForm.title.valid,touched:this.state.postForm.title.touched,value:this.state.postForm.title.value})),o.a.createElement("div",{className:"input-padding"},o.a.createElement(Q,{id:"image",label:"Image",control:"input",onChange:this.postInputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"image"),valid:this.state.postForm.image.valid,touched:this.state.postForm.image.touched}),o.a.createElement("div",{className:"new-post__preview-image"},!this.state.imagePreview&&o.a.createElement("p",null,"Please choose an image."),this.state.imagePreview&&o.a.createElement(X,{imageUrl:this.state.imagePreview,contain:!0,left:!0}))),o.a.createElement("div",{className:"input-padding"},o.a.createElement(G,{id:"content",label:"Content",control:"textarea",rows:"5",onChange:this.postInputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"content"),valid:this.state.postForm.content.valid,touched:this.state.postForm.content.touched,value:this.state.postForm.content.value})),o.a.createElement("div",{className:"input-padding"},o.a.createElement(G,{id:"taken_date",label:"Date photo was taken",control:"input",onChange:this.postInputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"taken_date"),valid:this.state.postForm.taken_date.valid,touched:this.state.postForm.taken_date.touched,value:this.state.postForm.taken_date.value})),o.a.createElement("div",{className:"input-padding"},o.a.createElement("div",null,o.a.createElement("p",null,"Location"),o.a.createElement("div",{className:"location-div"},o.a.createElement("p",null,this.state.postForm.location.value.text)))),o.a.createElement("div",null,o.a.createElement("p",null,"Please select a location: ")),o.a.createElement("div",{className:"map-div",style:{display:"flex",alignItems:"center",justifyContent:"center"}},o.a.createElement(rt,{id:"location",width:"450px",height:"250px",inputval:this.state.postForm.location.value.text,value:this.state.postForm.location.value,onChange:this.postLocationChangeHandler})),o.a.createElement("div",{className:"input-padding"},o.a.createElement(M.a,null,o.a.createElement(tt.a,null,o.a.createElement(G,{id:"ISO",label:"ISO",control:"input",onChange:this.postInputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"ISO"),valid:this.state.postForm.ISO.valid,touched:this.state.postForm.ISO.touched,value:this.state.postForm.ISO.value})),o.a.createElement(tt.a,null,o.a.createElement(G,{id:"shutter_speed",label:"Shutter Speed",control:"input",onChange:this.postInputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"shutter_speed"),valid:this.state.postForm.shutter_speed.valid,touched:this.state.postForm.shutter_speed.touched,value:this.state.postForm.shutter_speed.value})),o.a.createElement(tt.a,null,o.a.createElement(G,{id:"aperture",label:"Aperture",control:"input",onChange:this.postInputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"aperture"),valid:this.state.postForm.aperture.valid,touched:this.state.postForm.aperture.touched,value:this.state.postForm.aperture.value})))),o.a.createElement("div",{className:"input-padding"},o.a.createElement(G,{id:"camera",label:"Camera/Device",control:"input",onChange:this.postInputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"camera"),valid:this.state.postForm.camera.valid,touched:this.state.postForm.camera.touched,value:this.state.postForm.camera.value})),o.a.createElement("div",{className:"input-padding"},o.a.createElement(G,{id:"lens",label:"Lens",control:"input",onChange:this.postInputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"lens"),valid:this.state.postForm.lens.valid,touched:this.state.postForm.lens.touched,value:this.state.postForm.lens.value})),o.a.createElement("div",{className:"input-padding"},o.a.createElement(G,{id:"equipment",label:"Equipments",control:"input",onChange:this.postInputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"equipment"),valid:this.state.postForm.equipment.valid,touched:this.state.postForm.equipment.touched,value:this.state.postForm.equipment.value})),o.a.createElement("div",{className:"input-padding"},o.a.createElement(G,{id:"edit_soft",label:"Post-Editing Softwares",control:"input",onChange:this.postInputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"edit_soft"),valid:this.state.postForm.edit_soft.valid,touched:this.state.postForm.edit_soft.touched,value:this.state.postForm.edit_soft.value})),o.a.createElement(ct,{id:"user_rate",label:"Author Rating for Location",onChange:this.postRatingChangeHandler,value:this.state.postForm.user_rate.value})))):null:o.a.createElement(U,null):null}}]),e}(n.Component),ht=(a(356),function(t){return o.a.createElement("div",{className:"paginator"},t.children,o.a.createElement("div",{className:"paginator__controls"},t.currentPage>1&&o.a.createElement("button",{className:"paginator__control",onClick:t.onPrevious},"Previous"),t.currentPage<t.lastPage&&o.a.createElement("button",{className:"paginator__control",onClick:t.onNext},"Next")))}),dt=(a(357),function(t){function e(){return Object(p.a)(this,e),Object(d.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(g.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this;return this.props.postReviewEditing?o.a.createElement(T,{title:"Review this post",acceptEnabled:this.props.reviewIsValid,onCancelModal:this.props.cancelReviewHandler,onAcceptModal:this.props.acceptReviewHandler,isLoading:!1},o.a.createElement(W.a,null,o.a.createElement(ct,{id:"Rating",label:"Rate this location",onChange:this.props.postRatingChangeHandler,value:this.props.rating}),o.a.createElement("textarea",{rows:5,required:!0,value:this.props.comment,onChange:function(e){return t.props.postCommentHandler(e.target.value)}}))):null}}]),e}(n.Component)),mt=function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).state={isEditing:!1,posts:[],totalPosts:0,editPost:null,status:"",postPage:1,postsLoading:!0,editLoading:!1,bucket:[],reviewPost:!1,rating:3,oldRating:3,comment:"",ratingTouched:!1,commentTouched:!1,reviewIsValid:!1},a.addPost=function(t){a.setState(function(e){var a=Object(_.a)(e.posts);return 1===e.postPage&&(e.posts.length>=2&&a.pop(),a.unshift(t)),{posts:a,totalPosts:e.totalPosts+1}})},a.updatePost=function(t){a.setState(function(e){var a=Object(_.a)(e.posts),n=a.findIndex(function(e){return e._id===t._id});return n>-1&&(a[n]=t),{posts:a}})},a.loadPosts=function(t){t&&a.setState({postsLoading:!0,posts:[]});var e=a.state.postPage;"next"===t&&(e++,a.setState({postPage:e})),"previous"===t&&(e--,a.setState({postPage:e})),fetch("https://photography-spot-share.herokuapp.com/feed/posts?page="+e,{headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status)throw new Error("Failed to fetch posts.");return t.json()}).then(function(t){if(""===a.state.status)a.setState({posts:t.posts.map(function(t){return Object(R.a)({},t,{imagePath:t.imageUrl})}),totalPosts:t.totalItems,postsLoading:!1});else{for(var e=t.posts.map(function(t){return Object(R.a)({},t,{imagePath:t.imageUrl})}),n=[],o=a.state.status,s=0;s<e.length;s++){var r=e[s];-1===r.title.toLowerCase().search(o.toLowerCase())?-1===r.content.toLowerCase().search(o.toLowerCase())&&-1===r.location.text.toLowerCase().search(o.toLowerCase())&&-1===r.location.place_name.toLowerCase().search(o.toLowerCase())&&-1===r.ISO.toString().toLowerCase().search(o.toLowerCase())&&-1===r.shutter_speed.toLowerCase().search(o.toLowerCase())&&-1===r.aperture.toLowerCase().search(o.toLowerCase())&&-1===r.camera.toLowerCase().search(o.toLowerCase())&&-1===r.lens.toLowerCase().search(o.toLowerCase())&&-1===r.equipment.toLowerCase().search(o.toLowerCase())&&-1===r.edit_soft.toLowerCase().search(o.toLowerCase())||n.push(r):n.push(r)}a.setState({posts:n,totalPosts:n.length,postsLoading:!1})}}).catch(a.catchError)},a.statusUpdateHandler=function(t){void 0!==t&&t.preventDefault(),fetch("https://photography-spot-share.herokuapp.com/auth/status",{method:"PATCH",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({status:a.state.status})}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Can't update status!");return t.json()}).then(function(t){a.loadPosts()}).catch(a.catchError)},a.newPostHandler=function(){a.setState({isEditing:!0})},a.startEditPostHandler=function(t){a.setState(function(e){return{isEditing:!0,editPost:Object(R.a)({},e.posts.find(function(e){return e._id===t}))}})},a.cancelEditHandler=function(){a.setState({isEditing:!1,editPost:null})},a.finishEditHandler=function(t){a.setState({editLoading:!0});var e=new FormData;e.append("title",t.title),e.append("content",t.content),e.append("image",t.image),e.append("taken_date",t.taken_date),e.append("location",JSON.stringify(t.location)),e.append("ISO",t.ISO),e.append("shutter_speed",t.shutter_speed),e.append("aperture",t.aperture),e.append("camera",t.camera),e.append("lens",t.lens),e.append("equipment",t.equipment),e.append("edit_soft",t.edit_soft),e.append("user_rate",t.user_rate);var n="https://photography-spot-share.herokuapp.com/feed/posts",o="POST";a.state.editPost&&(n="https://photography-spot-share.herokuapp.com/feed/post/"+a.state.editPost._id,o="PUT"),fetch(n,{method:o,body:e,headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Creating or editing a post failed!");return t.json()}).then(function(t){a.setState(function(t){return{isEditing:!1,editPost:null,editLoading:!1}})}).catch(function(t){console.log(t),a.setState({isEditing:!1,editPost:null,editLoading:!1,error:t})})},a.statusInputChangeHandler=function(t,e){a.setState({status:e})},a.deletePostHandler=function(t){a.setState({postsLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/feed/post/"+t,{method:"DELETE",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Deleting a post failed!");return t.json()}).then(function(t){console.log(t),a.loadPosts()}).catch(function(t){console.log(t),a.setState({postsLoading:!1})})},a.bucketPostHandler=function(t){a.setState({postsLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/auth/bucket/"+t,{method:"POST",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Adding a post to bucket failed!");return t.json()}).then(function(e){console.log(e),a.loadPosts(),a.state.bucket.push(t)}).catch(function(t){console.log(t),a.setState({postsLoading:!1})})},a.bucketRemoveHandler=function(t){a.setState({postsLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/auth/bucket/"+t,{method:"DELETE",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Deleting a post from bucket failed!");return t.json()}).then(function(e){console.log(e),a.loadPosts();for(var n=0;n<a.state.bucket.length;n++)a.state.bucket[n]===t&&a.state.bucket.splice(n,1)}).catch(function(t){console.log(t),a.setState({postsLoading:!1})})},a.errorHandler=function(){a.setState({error:null})},a.catchError=function(t){a.setState({error:t})},a.startReviewHandler=function(t){var e=localStorage.getItem("userId");fetch("https://photography-spot-share.herokuapp.com/auth/ratings/"+e,{method:"GET",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Fetching ratings failed!");return t.json()}).then(function(e){for(var n=0;n<e.ratings.length;n++)if(e.ratings[n].post===t){a.setState({rating:e.ratings[n].rating,oldRating:e.ratings[n].rating,comment:e.ratings[n].comment,reviewIsValid:!0,ratingTouched:!0,commentTouched:!0});break}}).then(function(e){a.setState({reviewPost:t})}).catch(function(t){console.log(t)})},a.postCommentHandler=function(t){a.setState({comment:t,commentTouched:!0,reviewIsValid:a.state.ratingTouched})},a.postRatingChangeHandler=function(t){a.setState({rating:t,ratingTouched:!0,reviewIsValid:a.state.commentTouched})},a.cancelReviewHandler=function(){a.setState({rating:3,ratingTouched:!1,commentTouched:!1,reviewIsValid:!1,reviewPost:!1})},a.acceptReviewHandler=Object(u.a)(c.a.mark(function t(){var e,n,o,s,r,i,l,u,p;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=localStorage.getItem("userId"),a.setState({postsLoading:!0}),t.prev=2,t.next=5,fetch("https://photography-spot-share.herokuapp.com/auth/ratings/"+e,{method:"POST",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({postId:a.state.reviewPost,rating:a.state.rating,comment:a.state.comment})});case 5:if(200===(n=t.sent).status||201===n.status){t.next=8;break}throw new Error("Adding a review failed!");case 8:return t.next=10,n.json();case 10:return o=t.sent,s=!o.old_rating,t.next=14,fetch("https://photography-spot-share.herokuapp.com/auth/ratings/"+e,{method:"GET",headers:{Authorization:"Bearer "+a.props.token}});case 14:if(200===(i=t.sent).status||201===i.status){t.next=17;break}throw new Error("Fetching ratings failed!");case 17:return t.next=19,i.json();case 19:l=t.sent,console.log(l),u=0;case 22:if(!(u<l.ratings.length)){t.next=29;break}if(l.ratings[u].post!==a.state.reviewPost){t.next=26;break}return r=l.ratings[u]._id,t.abrupt("break",29);case 26:u++,t.next=22;break;case 29:return t.next=31,fetch("https://photography-spot-share.herokuapp.com/feed/rating/"+a.state.reviewPost,{method:"PATCH",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({userId:e,ratingId:r,oldRating:a.state.oldRating,newRating:s,value:a.state.rating})});case 31:if(200===(p=t.sent).status||201===p.status){t.next=34;break}throw new Error("Can't update review!");case 34:a.setState({postsLoading:!1,rating:3,ratingTouched:!1,comment:"",commentTouched:!1,reviewIsValid:!1,reviewPost:!1}),t.next=41;break;case 37:t.prev=37,t.t0=t.catch(2),console.log(t.t0),a.setState({postsLoading:!1});case 41:case"end":return t.stop()}},t,null,[[2,37]])})),a.clearSearchHandler=Object(u.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.setState({status:""});case 2:a.statusUpdateHandler();case 3:case"end":return t.stop()}},t)})),a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){var t=this;fetch("https://photography-spot-share.herokuapp.com/auth/status",{headers:{Authorization:"Bearer "+this.props.token}}).then(function(t){if(200!==t.status)throw new Error("Failed to fetch user status.");return t.json()}).then(function(e){t.setState({status:e.status})}).catch(this.catchError),fetch("https://photography-spot-share.herokuapp.com/auth/bucket",{headers:{Authorization:"Bearer "+this.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Fetching bucket posts failed!");return t.json()}).then(function(e){t.setState({bucket:e.bucket})}).catch(function(t){console.log(t)}),this.loadPosts(),V()("https://photography-spot-share.herokuapp.com").on("posts",function(e){"delete"===e.action?t.loadPosts():"update"===e.action&&t.updatePost(e.post)})}},{key:"render",value:function(){var t=this;return o.a.createElement(n.Fragment,null,o.a.createElement(dt,{reviewIsValid:this.state.reviewIsValid,cancelReviewHandler:this.cancelReviewHandler,acceptReviewHandler:this.acceptReviewHandler,postRatingChangeHandler:this.postRatingChangeHandler,rating:this.state.rating,postReviewEditing:this.state.reviewPost,comment:this.state.comment,postCommentHandler:this.postCommentHandler}),o.a.createElement(B,{error:this.state.error,onHandle:this.errorHandler}),o.a.createElement(pt,{editing:this.state.isEditing,selectedPost:this.state.editPost,loading:this.state.editLoading,onCancelEdit:this.cancelEditHandler,onFinishEdit:this.finishEditHandler}),o.a.createElement("section",{className:"feed__status"},o.a.createElement("form",{onSubmit:this.statusUpdateHandler},o.a.createElement(G,{type:"text",placeholder:"search for keywords...",control:"input",onChange:this.statusInputChangeHandler,value:this.state.status}),o.a.createElement(F,{mode:"flat",type:"submit"},"Search!"),o.a.createElement(F,{mode:"flat",onClick:this.clearSearchHandler},"Clear"))),o.a.createElement("section",{className:"feed"},this.state.postsLoading&&o.a.createElement("div",{style:{textAlign:"center",marginTop:"2 rem"}},o.a.createElement(U,null)),this.state.posts.length<=0&&!this.state.postsLoading?o.a.createElement("p",{style:{textAlign:"center"}},"No posts found."):null,!this.state.postsLoading&&o.a.createElement(ht,{onPrevious:this.loadPosts.bind(this,"previous"),onNext:this.loadPosts.bind(this,"next"),lastPage:Math.ceil(this.state.totalPosts/2),currentPage:this.state.postPage},this.state.posts.map(function(e){return o.a.createElement(J,{key:e._id,id:e._id,author:e.creator,date:new Date(e.createdAt).toLocaleDateString("en-US"),title:e.title,image:e.imageUrl,content:e.content,taken_date:e.taken_date,location:e.location,ISO:e.ISO,shutter_speed:e.shutter_speed,aperture:e.aperture,camera:e.camera,lens:e.lens,equipment:e.equipment,edit_soft:e.edit_soft,user_rate:e.user_rate,onStartEdit:t.startEditPostHandler.bind(t,e._id),onDelete:t.deletePostHandler.bind(t,e._id),onBucket:t.bucketPostHandler.bind(t,e._id),offBucket:t.bucketRemoveHandler.bind(t,e._id),userBucket:t.state.bucket,token:t.props.token,startReview:t.startReviewHandler.bind(t,e._id)})}))))}}]),e}(n.Component),gt=(a(358),function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).state={isEditing:!1,posts:[],totalPosts:0,editPost:null,status:"",postPage:1,postsLoading:!0,editLoading:!1,bucket:[],isNewPost:!1,reviewPost:!1,rating:3,oldRating:3,comment:"",ratingTouched:!1,commentTouched:!1,reviewIsValid:!1},a.addPost=function(t){a.setState(function(e){var a=Object(_.a)(e.posts);return 1===e.postPage&&(e.posts.length>=2&&a.pop(),a.unshift(t)),{posts:a,totalPosts:e.totalPosts+1}})},a.updatePost=function(t){a.setState(function(e){var a=Object(_.a)(e.posts),n=a.findIndex(function(e){return e._id===t._id});return n>-1&&(a[n]=t),{posts:a}})},a.loadPosts=function(t){t&&a.setState({postsLoading:!0,posts:[]});var e=a.state.postPage;"next"===t&&(e++,a.setState({postPage:e})),"previous"===t&&(e--,a.setState({postPage:e})),fetch("https://photography-spot-share.herokuapp.com/feed/posts?page="+e,{headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status)throw new Error("Failed to fetch posts.");return t.json()}).then(function(t){return Object(R.a)({},t,{posts:t.posts.filter(function(t){return a.props.userId===t.creator._id})})}).then(function(t){if(""===a.state.status)a.setState({posts:t.posts.map(function(t){return Object(R.a)({},t,{imagePath:t.imageUrl})}),totalPosts:t.totalItems,postsLoading:!1});else{for(var e=t.posts.map(function(t){return Object(R.a)({},t,{imagePath:t.imageUrl})}),n=[],o=a.state.status,s=0;s<e.length;s++){var r=e[s];-1===r.title.toLowerCase().search(o.toLowerCase())?-1===r.content.toLowerCase().search(o.toLowerCase())&&-1===r.location.text.toLowerCase().search(o.toLowerCase())&&-1===r.location.place_name.toLowerCase().search(o.toLowerCase())&&-1===r.ISO.toString().toLowerCase().search(o.toLowerCase())&&-1===r.shutter_speed.toLowerCase().search(o.toLowerCase())&&-1===r.aperture.toLowerCase().search(o.toLowerCase())&&-1===r.camera.toLowerCase().search(o.toLowerCase())&&-1===r.lens.toLowerCase().search(o.toLowerCase())&&-1===r.equipment.toLowerCase().search(o.toLowerCase())&&-1===r.edit_soft.toLowerCase().search(o.toLowerCase())||n.push(r):n.push(r)}a.setState({posts:n,totalPosts:n.length,postsLoading:!1})}}).catch(a.catchError)},a.statusUpdateHandler=function(t){void 0!==t&&t.preventDefault(),fetch("https://photography-spot-share.herokuapp.com/auth/status",{method:"PATCH",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({status:a.state.status})}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Can't update status!");return t.json()}).then(function(t){a.loadPosts()}).catch(a.catchError)},a.newPostHandler=function(){a.setState({isNewPost:!0,isEditing:!0})},a.startEditPostHandler=function(t){a.setState(function(e){return{isEditing:!0,editPost:Object(R.a)({},e.posts.find(function(e){return e._id===t}))}})},a.cancelEditHandler=function(){a.setState({isEditing:!1,editPost:null})},a.bucketPostHandler=function(t){a.setState({postsLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/auth/bucket/"+t,{method:"POST",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Adding a post to bucket failed!");return t.json()}).then(function(e){a.loadPosts(),a.state.bucket.push(t)}).catch(function(t){console.log(t),a.setState({postsLoading:!1})})},a.bucketRemoveHandler=function(t){a.setState({postsLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/auth/bucket/"+t,{method:"DELETE",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Deleting a post from bucket failed!");return t.json()}).then(function(e){a.loadPosts();for(var n=0;n<a.state.bucket.length;n++)a.state.bucket[n]===t&&a.state.bucket.splice(n,1)}).catch(function(t){console.log(t),a.setState({postsLoading:!1})})},a.finishEditHandler=function(t){a.setState({editLoading:!0});var e=new FormData;e.append("title",t.title),e.append("content",t.content),e.append("image",t.image),e.append("taken_date",t.taken_date),e.append("location",JSON.stringify(t.location)),e.append("ISO",t.ISO),e.append("shutter_speed",t.shutter_speed),e.append("aperture",t.aperture),e.append("camera",t.camera),e.append("lens",t.lens),e.append("equipment",t.equipment),e.append("edit_soft",t.edit_soft),e.append("user_rate",t.user_rate);var n="https://photography-spot-share.herokuapp.com/feed/posts",o="POST";a.state.editPost&&(n="https://photography-spot-share.herokuapp.com/feed/post/"+a.state.editPost._id,o="PUT"),fetch(n,{method:o,body:e,headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Creating or editing a post failed!");return t.json()}).then(function(t){a.setState(function(t){return{isEditing:!1,editPost:null,editLoading:!1}})}).catch(function(t){console.log(t),a.setState({isEditing:!1,editPost:null,editLoading:!1,error:t})})},a.statusInputChangeHandler=function(t,e){a.setState({status:e})},a.deletePostHandler=function(t){a.setState({postsLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/feed/post/"+t,{method:"DELETE",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Deleting a post failed!");return t.json()}).then(function(t){a.loadPosts()}).catch(function(t){console.log(t),a.setState({postsLoading:!1})})},a.errorHandler=function(){a.setState({error:null})},a.catchError=function(t){a.setState({error:t})},a.startReviewHandler=function(t){var e=localStorage.getItem("userId");fetch("https://photography-spot-share.herokuapp.com/auth/ratings/"+e,{method:"GET",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Fetching ratings failed!");return t.json()}).then(function(e){for(var n=0;n<e.ratings.length;n++)if(e.ratings[n].post===t){a.setState({rating:e.ratings[n].rating,oldRating:e.ratings[n].rating,comment:e.ratings[n].comment,reviewIsValid:!0,ratingTouched:!0,commentTouched:!0});break}}).then(function(e){a.setState({reviewPost:t})}).catch(function(t){console.log(t)})},a.postCommentHandler=function(t){a.setState({comment:t,commentTouched:!0,reviewIsValid:a.state.ratingTouched})},a.postRatingChangeHandler=function(t){a.setState({rating:t,ratingTouched:!0,reviewIsValid:a.state.commentTouched})},a.cancelReviewHandler=function(){a.setState({rating:3,ratingTouched:!1,commentTouched:!1,reviewIsValid:!1,reviewPost:!1})},a.acceptReviewHandler=Object(u.a)(c.a.mark(function t(){var e,n,o,s,r,i,l,u,p;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=localStorage.getItem("userId"),a.setState({postsLoading:!0}),t.prev=2,t.next=5,fetch("https://photography-spot-share.herokuapp.com/auth/ratings/"+e,{method:"POST",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({postId:a.state.reviewPost,rating:a.state.rating,comment:a.state.comment})});case 5:if(200===(n=t.sent).status||201===n.status){t.next=8;break}throw new Error("Adding a review failed!");case 8:return t.next=10,n.json();case 10:return o=t.sent,s=!o.old_rating,t.next=14,fetch("https://photography-spot-share.herokuapp.com/auth/ratings/"+e,{method:"GET",headers:{Authorization:"Bearer "+a.props.token}});case 14:if(200===(i=t.sent).status||201===i.status){t.next=17;break}throw new Error("Fetching ratings failed!");case 17:return t.next=19,i.json();case 19:l=t.sent,u=0;case 21:if(!(u<l.ratings.length)){t.next=28;break}if(l.ratings[u].post!==a.state.reviewPost){t.next=25;break}return r=l.ratings[u]._id,t.abrupt("break",28);case 25:u++,t.next=21;break;case 28:return t.next=30,fetch("https://photography-spot-share.herokuapp.com/feed/rating/"+a.state.reviewPost,{method:"PATCH",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({userId:e,ratingId:r,oldRating:a.state.oldRating,newRating:s,value:a.state.rating})});case 30:if(200===(p=t.sent).status||201===p.status){t.next=33;break}throw new Error("Can't update review!");case 33:a.setState({postsLoading:!1,rating:3,ratingTouched:!1,comment:"",commentTouched:!1,reviewIsValid:!1,reviewPost:!1}),t.next=40;break;case 36:t.prev=36,t.t0=t.catch(2),console.log(t.t0),a.setState({postsLoading:!1});case 40:case"end":return t.stop()}},t,null,[[2,36]])})),a.clearSearchHandler=Object(u.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.setState({status:""});case 2:a.statusUpdateHandler();case 3:case"end":return t.stop()}},t)})),a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){var t=this;fetch("https://photography-spot-share.herokuapp.com/auth/status",{headers:{Authorization:"Bearer "+this.props.token}}).then(function(t){if(200!==t.status)throw new Error("Failed to fetch user status.");return t.json()}).then(function(e){t.setState({status:e.status})}).catch(this.catchError),fetch("https://photography-spot-share.herokuapp.com/auth/bucket",{headers:{Authorization:"Bearer "+this.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Fetching bucket posts failed!");return t.json()}).then(function(e){t.setState({bucket:e.bucket})}).catch(function(t){console.log(t)}),this.loadPosts(),V()("https://photography-spot-share.herokuapp.com").on("posts",function(e){"create"===e.action?t.addPost(e.post):"update"===e.action?t.updatePost(e.post):"delete"===e.action&&t.loadPosts()})}},{key:"render",value:function(){var t=this;return o.a.createElement(n.Fragment,null,o.a.createElement(dt,{reviewIsValid:this.state.reviewIsValid,cancelReviewHandler:this.cancelReviewHandler,acceptReviewHandler:this.acceptReviewHandler,postRatingChangeHandler:this.postRatingChangeHandler,rating:this.state.rating,postReviewEditing:this.state.reviewPost,comment:this.state.comment,postCommentHandler:this.postCommentHandler}),o.a.createElement(B,{error:this.state.error,onHandle:this.errorHandler}),o.a.createElement(pt,{editing:this.state.isEditing,selectedPost:this.state.editPost,loading:this.state.editLoading,onCancelEdit:this.cancelEditHandler,onFinishEdit:this.finishEditHandler,isNewPost:this.state.isNewPost}),o.a.createElement("section",{className:"feed__status"},o.a.createElement("form",{onSubmit:this.statusUpdateHandler},o.a.createElement(G,{type:"text",placeholder:"search for keywords...",control:"input",onChange:this.statusInputChangeHandler,value:this.state.status}),o.a.createElement(F,{mode:"flat",type:"submit"},"Search!"),o.a.createElement(F,{mode:"flat",onClick:this.clearSearchHandler},"Clear"))),o.a.createElement("section",{className:"feed__control"},o.a.createElement(F,{mode:"raised",design:"accent",onClick:this.newPostHandler},"New Post")),o.a.createElement("section",{className:"feed"},this.state.postsLoading&&o.a.createElement("div",{style:{textAlign:"center",marginTop:"2 rem"}},o.a.createElement(U,null)),this.state.posts.length<=0&&!this.state.postsLoading?o.a.createElement("p",{style:{textAlign:"center"}},"No posts found."):null,!this.state.postsLoading&&o.a.createElement(ht,{onPrevious:this.loadPosts.bind(this,"previous"),onNext:this.loadPosts.bind(this,"next"),lastPage:Math.ceil(this.state.totalPosts/2),currentPage:this.state.postPage},this.state.posts.map(function(e){return o.a.createElement(J,{key:e._id,id:e._id,author:e.creator,date:new Date(e.createdAt).toLocaleDateString("en-US"),title:e.title,image:e.imageUrl,content:e.content,taken_date:e.taken_date,location:e.location,ISO:e.ISO,shutter_speed:e.shutter_speed,aperture:e.aperture,camera:e.camera,lens:e.lens,equipment:e.equipment,edit_soft:e.edit_soft,user_rate:e.user_rate,onStartEdit:t.startEditPostHandler.bind(t,e._id),onDelete:t.deletePostHandler.bind(t,e._id),onBucket:t.bucketPostHandler.bind(t,e._id),offBucket:t.bucketRemoveHandler.bind(t,e._id),userBucket:t.state.bucket,token:t.props.token,startReview:t.startReviewHandler.bind(t,e._id)})}))))}}]),e}(n.Component)),ft=(a(359),a(379)),vt=function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(s)))).state={isEditing:!1,posts:[],totalPosts:0,editPost:null,status:"",postPage:1,postsLoading:!0,editLoading:!1,bucket:[],reviewPost:!1,rating:3,comment:"",ratingTouched:!1,commentTouched:!1,reviewIsValid:!1,show_post_limit:3,show_post_limit_region:3,posts_to_display:[],regionRatings:[],redirected:!1},a.addPost=function(t){a.setState(function(e){var a=Object(_.a)(e.posts);return 1===e.postPage&&(e.posts.length>=2&&a.pop(),a.unshift(t)),{posts:a,totalPosts:e.totalPosts+1}})},a.updatePost=function(t){a.setState(function(e){var a=Object(_.a)(e.posts),n=a.findIndex(function(e){return e._id===t._id});return n>-1&&(a[n]=t),{posts:a}})},a.loadPosts=function(t){t&&a.setState({postsLoading:!0,posts:[]});var e=a.state.postPage;"next"===t&&(e++,a.setState({postPage:e})),"previous"===t&&(e--,a.setState({postPage:e})),fetch("https://photography-spot-share.herokuapp.com/feed/all-posts",{headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status)throw new Error("Failed to fetch posts.");return t.json()}).then(function(t){if(""===a.state.status)a.setState({posts:t.posts.map(function(t){return Object(R.a)({},t,{imagePath:t.imageUrl})}),totalPosts:t.totalItems,postsLoading:!1});else{for(var e=t.posts.map(function(t){return Object(R.a)({},t,{imagePath:t.imageUrl})}),n=[],o=a.state.status,s=0;s<e.length;s++){var r=e[s];-1===r.title.toLowerCase().search(o.toLowerCase())?-1===r.content.toLowerCase().search(o.toLowerCase())&&-1===r.location.text.toLowerCase().search(o.toLowerCase())&&-1===r.location.place_name.toLowerCase().search(o.toLowerCase())&&-1===r.ISO.toString().toLowerCase().search(o.toLowerCase())&&-1===r.shutter_speed.toLowerCase().search(o.toLowerCase())&&-1===r.aperture.toLowerCase().search(o.toLowerCase())&&-1===r.camera.toLowerCase().search(o.toLowerCase())&&-1===r.lens.toLowerCase().search(o.toLowerCase())&&-1===r.equipment.toLowerCase().search(o.toLowerCase())&&-1===r.edit_soft.toLowerCase().search(o.toLowerCase())||n.push(r):n.push(r)}a.setState({posts:n,totalPosts:n.length,postsLoading:!1})}}).then(function(t){var e=a.state.posts,n={};e.forEach(function(t){var e=t.location.context.length,a=t.location.context[e-2].text;Object.keys(n).includes(a)?n[a].push(t):n[a]=[t]});var o=[];Object.keys(n).forEach(function(t){var e,a=n[t],s=t,r=0,i=0;a.forEach(function(t){i+=t.rating_num,r+=t.rating_num*t.rating}),e=0!==i?r/i:0;var l=a[0].location.context.length,c={region:s,country:a[0].location.context[l-1].text,avgRating:e};o.push(c)}),a.setState({regionRatings:o})}).catch(a.catchError)},a.statusUpdateHandler=function(t){void 0!==t&&t.preventDefault(),fetch("https://photography-spot-share.herokuapp.com/auth/status",{method:"PATCH",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({status:a.state.status})}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Can't update status!");return t.json()}).then(function(t){a.loadPosts()}).catch(a.catchError)},a.newPostHandler=function(){a.setState({isEditing:!0})},a.startEditPostHandler=function(t){a.setState(function(e){return{isEditing:!0,editPost:Object(R.a)({},e.posts.find(function(e){return e._id===t}))}})},a.cancelEditHandler=function(){a.setState({isEditing:!1,editPost:null})},a.finishEditHandler=function(t){a.setState({editLoading:!0});var e=new FormData;e.append("title",t.title),e.append("content",t.content),e.append("image",t.image),e.append("taken_date",t.taken_date),e.append("location",JSON.stringify(t.location)),e.append("ISO",t.ISO),e.append("shutter_speed",t.shutter_speed),e.append("aperture",t.aperture),e.append("camera",t.camera),e.append("lens",t.lens),e.append("equipment",t.equipment),e.append("edit_soft",t.edit_soft),e.append("user_rate",t.user_rate);var n="https://photography-spot-share.herokuapp.com/feed/posts",o="POST";a.state.editPost&&(n="https://photography-spot-share.herokuapp.com/feed/post/"+a.state.editPost._id,o="PUT"),fetch(n,{method:o,body:e,headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Creating or editing a post failed!");return t.json()}).then(function(t){a.setState(function(t){return{isEditing:!1,editPost:null,editLoading:!1}})}).catch(function(t){console.log(t),a.setState({isEditing:!1,editPost:null,editLoading:!1,error:t})})},a.statusInputChangeHandler=function(t,e){a.setState({status:e})},a.deletePostHandler=function(t){a.setState({postsLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/feed/post/"+t,{method:"DELETE",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Deleting a post failed!");return t.json()}).then(function(t){console.log(t),a.loadPosts()}).catch(function(t){console.log(t),a.setState({postsLoading:!1})})},a.bucketPostHandler=function(t){a.setState({postsLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/auth/bucket/"+t,{method:"POST",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Adding a post to bucket failed!");return t.json()}).then(function(e){console.log(e),a.loadPosts(),a.state.bucket.push(t)}).catch(function(t){console.log(t),a.setState({postsLoading:!1})})},a.bucketRemoveHandler=function(t){a.setState({postsLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/auth/bucket/"+t,{method:"DELETE",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Deleting a post from bucket failed!");return t.json()}).then(function(e){console.log(e),a.loadPosts();for(var n=0;n<a.state.bucket.length;n++)a.state.bucket[n]===t&&a.state.bucket.splice(n,1)}).catch(function(t){console.log(t),a.setState({postsLoading:!1})})},a.errorHandler=function(){a.setState({error:null})},a.catchError=function(t){a.setState({error:t})},a.startReviewHandler=function(t){var e=localStorage.getItem("userId");fetch("https://photography-spot-share.herokuapp.com/auth/ratings/"+e,{method:"GET",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Fetching ratings failed!");return t.json()}).then(function(e){for(var n=0;n<e.ratings.length;n++)if(e.ratings[n].post===t){a.setState({rating:e.ratings[n].rating,comment:e.ratings[n].comment,reviewIsValid:!0,ratingTouched:!0,commentTouched:!0});break}}).then(function(e){a.setState({reviewPost:t})}).catch(function(t){console.log(t)})},a.postCommentHandler=function(t){a.setState({comment:t,commentTouched:!0,reviewIsValid:a.state.ratingTouched})},a.postRatingChangeHandler=function(t){a.setState({rating:t,ratingTouched:!0,reviewIsValid:a.state.commentTouched})},a.cancelReviewHandler=function(){a.setState({rating:3,ratingTouched:!1,commentTouched:!1,reviewIsValid:!1,reviewPost:!1})},a.acceptReviewHandler=Object(u.a)(c.a.mark(function t(){var e,n,o,s,r,i,l;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=localStorage.getItem("userId"),a.setState({postsLoading:!0}),t.prev=2,t.next=5,fetch("https://photography-spot-share.herokuapp.com/auth/ratings/"+e,{method:"POST",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({postId:a.state.reviewPost,rating:a.state.rating,comment:a.state.comment})});case 5:if(200===(n=t.sent).status||201===n.status){t.next=8;break}throw new Error("Adding a review failed!");case 8:return t.next=10,fetch("https://photography-spot-share.herokuapp.com/auth/ratings/"+e,{method:"GET",headers:{Authorization:"Bearer "+a.props.token}});case 10:if(200===(s=t.sent).status||201===s.status){t.next=13;break}throw new Error("Fetching ratings failed!");case 13:return t.next=15,s.json();case 15:r=t.sent,console.log(r),i=0;case 18:if(!(i<r.ratings.length)){t.next=26;break}if(r.ratings[i].post!==a.state.reviewPost){t.next=23;break}return o=r.ratings[i]._id,console.log(o),t.abrupt("break",26);case 23:i++,t.next=18;break;case 26:return t.next=28,fetch("https://photography-spot-share.herokuapp.com/feed/rating/"+a.state.reviewPost,{method:"PATCH",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({userId:e,ratingId:o})});case 28:if(200===(l=t.sent).status||201===l.status){t.next=31;break}throw new Error("Can't update review!");case 31:a.setState({postsLoading:!1,rating:3,ratingTouched:!1,comment:"",commentTouched:!1,reviewIsValid:!1,reviewPost:!1}),t.next=38;break;case 34:t.prev=34,t.t0=t.catch(2),console.log(t.t0),a.setState({postsLoading:!1});case 38:case"end":return t.stop()}},t,null,[[2,34]])})),a.clearSearchHandler=Object(u.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.setState({status:""});case 2:a.statusUpdateHandler();case 3:case"end":return t.stop()}},t)})),a.renderTopPostData=function(){return JSON.parse(JSON.stringify(a.state.posts)).sort(function(t,e){return e.rating-t.rating}).splice(0,a.state.show_post_limit).map(function(t){return o.a.createElement("tr",{key:t._id,style:{borderLeft:"5px solid #134f2d"}},o.a.createElement("td",null,t.title),o.a.createElement("td",null,o.a.createElement("img",{src:"https://photography-spot-share.herokuapp.com/"+t.imageUrl,alt:t.title,className:"thumbnail"})),o.a.createElement("td",null,t.location.text),o.a.createElement("td",null,a.ratingHelper(t.rating)),o.a.createElement("td",null,t.creator.name),o.a.createElement("td",null,o.a.createElement(x.a,{to:t._id},o.a.createElement(F,{mode:"flat"},"View"))))})},a.ratingHelper=function(t){return 0===t?"None":t},a.renderTopRegionData=function(){return JSON.parse(JSON.stringify(a.state.regionRatings)).sort(function(t,e){return e.avgRating-t.avgRating}).splice(0,a.state.show_post_limit_region).map(function(t){return o.a.createElement("tr",{key:t.region,style:{borderLeft:"5px solid #134f2d"}},o.a.createElement("td",null,t.region),o.a.createElement("td",null,t.country),o.a.createElement("td",null,t.avgRating),o.a.createElement("td",null,o.a.createElement(F,{mode:"flat",onClick:Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({status:t.region});case 2:return e.next=4,a.statusUpdateHandler();case 4:a.setState({redirected:!0});case 5:case"end":return e.stop()}},e)}))},"Search")))})},a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){var t=this;fetch("https://photography-spot-share.herokuapp.com/auth/status",{headers:{Authorization:"Bearer "+this.props.token}}).then(function(t){if(200!==t.status)throw new Error("Failed to fetch user status.");return t.json()}).then(function(e){t.setState({status:e.status})}).catch(this.catchError),fetch("https://photography-spot-share.herokuapp.com/auth/bucket",{headers:{Authorization:"Bearer "+this.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Fetching bucket posts failed!");return t.json()}).then(function(e){t.setState({bucket:e.bucket})}).catch(function(t){console.log(t)}),this.loadPosts(),V()("https://photography-spot-share.herokuapp.com").on("posts",function(e){"create"===e.action?t.addPost(e.post):"update"===e.action?t.updatePost(e.post):"delete"===e.action&&t.loadPosts()})}},{key:"render",value:function(){var t=this;return 0===this.state.posts.length?o.a.createElement(U,null):this.state.redirected?o.a.createElement(E.a,{to:"/"}):[o.a.createElement("section",{className:"feed__status",key:"search",style:{textAlign:"center"}},o.a.createElement("form",{onSubmit:this.statusUpdateHandler},o.a.createElement(G,{type:"text",placeholder:"search for keywords...",control:"input",onChange:this.statusInputChangeHandler,value:this.state.status}),o.a.createElement(F,{mode:"flat",type:"submit"},"Search!"),o.a.createElement(F,{mode:"flat",onClick:this.clearSearchHandler},"Clear"))),o.a.createElement("div",{key:"title",style:{textAlign:"center",paddingTop:"3rem"}},o.a.createElement("h2",null,"Top-rated Posts:")),o.a.createElement("div",{key:"topratepost",style:{display:"flex",alignItems:"center",justifyContent:"center",paddingBottom:"2rem",paddingLeft:"2rem",paddingRight:"2rem",textAlign:"center"}},o.a.createElement(ft.a,{striped:!0,bordered:!0,hover:!0},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Post"),o.a.createElement("th",null,"Preview"),o.a.createElement("th",null,"Location"),o.a.createElement("th",null,"Public Rating"),o.a.createElement("th",null,"Author"),o.a.createElement("th",null,"View"))),o.a.createElement("tbody",null,this.renderTopPostData()))),o.a.createElement("div",{key:"moreButton",style:{textAlign:"center",padding:"1rem"}},o.a.createElement(F,{mode:"flat",onClick:function(){t.setState({show_post_limit:t.state.show_post_limit+3})}},"More")),o.a.createElement("div",{key:"title-geo",style:{textAlign:"center",paddingTop:"3rem"}},o.a.createElement("h2",null,"Top-rated Regions:")),o.a.createElement("div",{key:"toprategeo",style:{display:"flex",alignItems:"center",justifyContent:"center",paddingBottom:"2rem",paddingLeft:"2rem",paddingRight:"2rem",textAlign:"center"}},o.a.createElement(ft.a,{striped:!0,bordered:!0,hover:!0},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Region"),o.a.createElement("th",null,"Country"),o.a.createElement("th",null,"Average Rating"),o.a.createElement("th",null,"Filter"))),o.a.createElement("tbody",null,this.renderTopRegionData()))),o.a.createElement("div",{key:"moreButtonRegion",style:{textAlign:"center",padding:"1rem"}},o.a.createElement(F,{mode:"flat",onClick:function(){t.setState({show_post_limit_region:t.state.show_post_limit_region+3})}},"More"))]}}]),e}(n.Component),Et=a(394),bt=a(380),wt=(a(360),function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(s)))).state={cardReveal:!1},a.Card=function(){return o.a.createElement(Et.a,{style:{width:"10rem"}},o.a.createElement(Et.a.Img,{variant:"top",src:"https://photography-spot-share.herokuapp.com/"+a.props.image,alt:a.props.title}),o.a.createElement(Et.a.Body,null,o.a.createElement(Et.a.Title,{className:"title"},a.props.title),o.a.createElement(Et.a.Text,{className:"location"},a.props.location),o.a.createElement(bt.a,null,o.a.createElement(x.a,{to:a.props.id},o.a.createElement(N.a,{size:"sm",variant:"outline-dark"},"View")),o.a.createElement(N.a,{size:"sm",variant:"outline-dark",className:"closeButton",onClick:function(){a.setState({cardReveal:!1})}},"Close"))))},a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this;return o.a.createElement("div",{className:"pin"},o.a.createElement("img",{src:"cam_marker.png",alt:"Spot",style:{width:"30px",height:"100%"},onClick:function(){t.setState({cardReveal:!t.state.cardReveal})}}),this.state.cardReveal?this.Card():null)}}]),e}(n.Component)),kt=function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(s)))).state={isEditing:!1,spots:[],postsLoading:!0,viewport:{width:"800px",height:"400px",latitude:44.161,longitude:-98.464,zoom:2}},a.loadPosts=function(){fetch("https://photography-spot-share.herokuapp.com/feed/all-posts",{headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status)throw new Error("Failed to fetch posts.");return t.json()}).then(function(t){return Object(R.a)({},t,{posts:t.posts.filter(function(t){return a.state.bucket.includes(t._id)})})}).then(function(t){a.setState({spots:t.posts.map(function(t){return Object(R.a)({},t,{imagePath:t.imageUrl})}),postsLoading:!1})}).catch(a.catchError)},a.createMarkers=function(){for(var t=[],e=0;e<a.state.spots.length;e++)t.push(o.a.createElement(et.b,{latitude:a.state.spots[e].location.center[1],longitude:a.state.spots[e].location.center[0],offsetLeft:-15,offsetTop:-30,key:e},o.a.createElement("div",null,o.a.createElement(wt,{key:e,title:a.state.spots[e].title,image:a.state.spots[e].imageUrl,location:a.state.spots[e].location.text,id:a.state.spots[e]._id}))));return t},a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){var t=this;fetch("https://photography-spot-share.herokuapp.com/auth/bucket",{headers:{Authorization:"Bearer "+this.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Fetching bucket posts failed!");return t.json()}).then(function(e){t.setState({bucket:e.bucket})}).catch(function(t){console.log(t)}),this.loadPosts(),V()("https://photography-spot-share.herokuapp.com").on("posts",function(e){"update"===e.action?t.updatePost(e.post):"delete"===e.action&&t.loadPosts()})}},{key:"render",value:function(){var t=this;return this.state.postsLoading?o.a.createElement(U,null):o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement("h2",null,"Bucket List Locations:"),o.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center"}},o.a.createElement(et.c,Object.assign({},this.state.viewport,{onViewportChange:function(e){return t.setState({viewport:e})},mapboxApiAccessToken:"pk.eyJ1IjoieTI2MmhhbiIsImEiOiJjanozamU2bmkwMzJ5M2d0Nm84ZW5meHhzIn0.L1kW4Q7vNyX0fCJJEYI5PA",mapStyle:"mapbox://styles/y262han/cjz3kx9a80fby1cr3d8oydttt"}),this.createMarkers())))}}]),e}(n.Component),yt=(a(361),function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).state={isEditing:!1,posts:[],totalPosts:0,editPost:null,status:"",postPage:1,postsLoading:!0,editLoading:!1,bucket:[],reviewPost:!1,rating:3,oldRating:3,comment:"",ratingTouched:!1,commentTouched:!1,reviewIsValid:!1},a.addPost=function(t){a.setState(function(e){var a=Object(_.a)(e.posts);return 1===e.postPage&&(e.posts.length>=2&&a.pop(),a.unshift(t)),{posts:a,totalPosts:e.totalPosts+1}})},a.updatePost=function(t){a.setState(function(e){var a=Object(_.a)(e.posts),n=a.findIndex(function(e){return e._id===t._id});return n>-1&&(a[n]=t),{posts:a}})},a.loadPosts=function(t){t&&a.setState({postsLoading:!0,posts:[]});var e=a.state.postPage;"next"===t&&(e++,a.setState({postPage:e})),"previous"===t&&(e--,a.setState({postPage:e})),fetch("https://photography-spot-share.herokuapp.com/feed/posts?page="+e,{headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status)throw new Error("Failed to fetch posts.");return t.json()}).then(function(t){return Object(R.a)({},t,{posts:t.posts.filter(function(t){return a.state.bucket.includes(t._id)})})}).then(function(t){if(""===a.state.status)a.setState({posts:t.posts.map(function(t){return Object(R.a)({},t,{imagePath:t.imageUrl})}),totalPosts:t.totalItems,postsLoading:!1});else{for(var e=t.posts.map(function(t){return Object(R.a)({},t,{imagePath:t.imageUrl})}),n=[],o=a.state.status,s=0;s<e.length;s++){var r=e[s];-1===r.title.toLowerCase().search(o.toLowerCase())?-1===r.content.toLowerCase().search(o.toLowerCase())&&-1===r.location.text.toLowerCase().search(o.toLowerCase())&&-1===r.location.place_name.toLowerCase().search(o.toLowerCase())&&-1===r.ISO.toString().toLowerCase().search(o.toLowerCase())&&-1===r.shutter_speed.toLowerCase().search(o.toLowerCase())&&-1===r.aperture.toLowerCase().search(o.toLowerCase())&&-1===r.camera.toLowerCase().search(o.toLowerCase())&&-1===r.lens.toLowerCase().search(o.toLowerCase())&&-1===r.equipment.toLowerCase().search(o.toLowerCase())&&-1===r.edit_soft.toLowerCase().search(o.toLowerCase())||n.push(r):n.push(r)}a.setState({posts:n,totalPosts:n.length,postsLoading:!1})}}).catch(a.catchError)},a.statusUpdateHandler=function(t){void 0!==t&&t.preventDefault(),fetch("https://photography-spot-share.herokuapp.com/auth/status",{method:"PATCH",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({status:a.state.status})}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Can't update status!");return t.json()}).then(function(t){a.loadPosts()}).catch(a.catchError)},a.newPostHandler=function(){a.setState({isEditing:!0})},a.startEditPostHandler=function(t){a.setState(function(e){return{isEditing:!0,editPost:Object(R.a)({},e.posts.find(function(e){return e._id===t}))}})},a.cancelEditHandler=function(){a.setState({isEditing:!1,editPost:null})},a.bucketPostHandler=function(t){a.setState({postsLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/auth/bucket/"+t,{method:"POST",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Adding a post to bucket failed!");return t.json()}).then(function(e){console.log(e),a.loadPosts(),a.state.bucket.push(t)}).catch(function(t){console.log(t),a.setState({postsLoading:!1})})},a.bucketRemoveHandler=function(t){a.setState({postsLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/auth/bucket/"+t,{method:"DELETE",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Deleting a post from bucket failed!");return t.json()}).then(function(e){console.log(e),a.loadPosts();for(var n=0;n<a.state.bucket.length;n++)a.state.bucket[n]===t&&a.state.bucket.splice(n,1)}).catch(function(t){console.log(t),a.setState({postsLoading:!1})})},a.finishEditHandler=function(t){a.setState({editLoading:!0});var e=new FormData;e.append("title",t.title),e.append("content",t.content),e.append("image",t.image),e.append("taken_date",t.taken_date),e.append("location",JSON.stringify(t.location)),e.append("ISO",t.ISO),e.append("shutter_speed",t.shutter_speed),e.append("aperture",t.aperture),e.append("camera",t.camera),e.append("lens",t.lens),e.append("equipment",t.equipment),e.append("edit_soft",t.edit_soft),e.append("user_rate",t.user_rate);var n="https://photography-spot-share.herokuapp.com/feed/posts",o="POST";a.state.editPost&&(n="https://photography-spot-share.herokuapp.com/feed/post/"+a.state.editPost._id,o="PUT"),fetch(n,{method:o,body:e,headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Creating or editing a post failed!");return t.json()}).then(function(t){console.log(t),a.setState(function(t){return{isEditing:!1,editPost:null,editLoading:!1}})}).catch(function(t){console.log(t),a.setState({isEditing:!1,editPost:null,editLoading:!1,error:t})})},a.statusInputChangeHandler=function(t,e){a.setState({status:e})},a.deletePostHandler=function(t){a.setState({postsLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/feed/post/"+t,{method:"DELETE",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Deleting a post failed!");return t.json()}).then(function(t){console.log(t),a.loadPosts()}).catch(function(t){console.log(t),a.setState({postsLoading:!1})})},a.errorHandler=function(){a.setState({error:null})},a.catchError=function(t){a.setState({error:t})},a.startReviewHandler=function(t){var e=localStorage.getItem("userId");fetch("https://photography-spot-share.herokuapp.com/auth/ratings/"+e,{method:"GET",headers:{Authorization:"Bearer "+a.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Fetching ratings failed!");return t.json()}).then(function(e){for(var n=0;n<e.ratings.length;n++)if(e.ratings[n].post===t){a.setState({rating:e.ratings[n].rating,oldRating:e.ratings[n].rating,comment:e.ratings[n].comment,reviewIsValid:!0,ratingTouched:!0,commentTouched:!0});break}}).then(function(e){a.setState({reviewPost:t})}).catch(function(t){console.log(t)})},a.postCommentHandler=function(t){a.setState({comment:t,commentTouched:!0,reviewIsValid:a.state.ratingTouched})},a.postRatingChangeHandler=function(t){a.setState({rating:t,ratingTouched:!0,reviewIsValid:a.state.commentTouched})},a.cancelReviewHandler=function(){a.setState({rating:3,ratingTouched:!1,commentTouched:!1,reviewIsValid:!1,reviewPost:!1})},a.acceptReviewHandler=Object(u.a)(c.a.mark(function t(){var e,n,o,s,r,i,l,u,p;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=localStorage.getItem("userId"),a.setState({postsLoading:!0}),t.prev=2,t.next=5,fetch("https://photography-spot-share.herokuapp.com/auth/ratings/"+e,{method:"POST",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({postId:a.state.reviewPost,rating:a.state.rating,comment:a.state.comment})});case 5:if(200===(n=t.sent).status||201===n.status){t.next=8;break}throw new Error("Adding a review failed!");case 8:return t.next=10,n.json();case 10:return o=t.sent,s=!o.old_rating,t.next=14,fetch("https://photography-spot-share.herokuapp.com/auth/ratings/"+e,{method:"GET",headers:{Authorization:"Bearer "+a.props.token}});case 14:if(200===(i=t.sent).status||201===i.status){t.next=17;break}throw new Error("Fetching ratings failed!");case 17:return t.next=19,i.json();case 19:l=t.sent,console.log(l),u=0;case 22:if(!(u<l.ratings.length)){t.next=30;break}if(l.ratings[u].post!==a.state.reviewPost){t.next=27;break}return r=l.ratings[u]._id,console.log(r),t.abrupt("break",30);case 27:u++,t.next=22;break;case 30:return t.next=32,fetch("https://photography-spot-share.herokuapp.com/feed/rating/"+a.state.reviewPost,{method:"PATCH",headers:{Authorization:"Bearer "+a.props.token,"Content-Type":"application/json"},body:JSON.stringify({userId:e,ratingId:r,oldRating:a.state.oldRating,newRating:s,value:a.state.rating})});case 32:if(200===(p=t.sent).status||201===p.status){t.next=35;break}throw new Error("Can't update review!");case 35:a.setState({postsLoading:!1,rating:3,ratingTouched:!1,comment:"",commentTouched:!1,reviewIsValid:!1,reviewPost:!1}),t.next=42;break;case 38:t.prev=38,t.t0=t.catch(2),console.log(t.t0),a.setState({postsLoading:!1});case 42:case"end":return t.stop()}},t,null,[[2,38]])})),a.clearSearchHandler=Object(u.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.setState({status:""});case 2:a.statusUpdateHandler();case 3:case"end":return t.stop()}},t)})),a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){var t=this;fetch("https://photography-spot-share.herokuapp.com/auth/status",{headers:{Authorization:"Bearer "+this.props.token}}).then(function(t){if(200!==t.status)throw new Error("Failed to fetch user status.");return t.json()}).then(function(e){t.setState({status:e.status})}).catch(this.catchError),fetch("https://photography-spot-share.herokuapp.com/auth/bucket",{headers:{Authorization:"Bearer "+this.props.token}}).then(function(t){if(200!==t.status&&201!==t.status)throw new Error("Fetching bucket posts failed!");return t.json()}).then(function(e){t.setState({bucket:e.bucket})}).catch(function(t){console.log(t)}),this.loadPosts(),V()("https://photography-spot-share.herokuapp.com").on("posts",function(e){"create"===e.action?t.addPost(e.post):"update"===e.action?t.updatePost(e.post):"delete"===e.action&&t.loadPosts()})}},{key:"render",value:function(){var t=this;return o.a.createElement(n.Fragment,null,o.a.createElement(dt,{reviewIsValid:this.state.reviewIsValid,cancelReviewHandler:this.cancelReviewHandler,acceptReviewHandler:this.acceptReviewHandler,postRatingChangeHandler:this.postRatingChangeHandler,rating:this.state.rating,postReviewEditing:this.state.reviewPost,comment:this.state.comment,postCommentHandler:this.postCommentHandler}),o.a.createElement(B,{error:this.state.error,onHandle:this.errorHandler}),o.a.createElement(pt,{editing:this.state.isEditing,selectedPost:this.state.editPost,loading:this.state.editLoading,onCancelEdit:this.cancelEditHandler,onFinishEdit:this.finishEditHandler}),o.a.createElement("section",{className:"feed__status"},o.a.createElement("form",{onSubmit:this.statusUpdateHandler},o.a.createElement(G,{type:"text",placeholder:"search for keywords...",control:"input",onChange:this.statusInputChangeHandler,value:this.state.status}),o.a.createElement(F,{mode:"flat",type:"submit"},"Search!"),o.a.createElement(F,{mode:"flat",onClick:this.clearSearchHandler},"Clear"))),o.a.createElement("section",{className:"feed"},this.state.postsLoading&&o.a.createElement("div",{style:{textAlign:"center",marginTop:"2 rem"}},o.a.createElement(U,null)),this.state.posts.length<=0&&!this.state.postsLoading?o.a.createElement("p",{style:{textAlign:"center"}},"No posts found."):null,!this.state.postsLoading&&o.a.createElement(ht,{onPrevious:this.loadPosts.bind(this,"previous"),onNext:this.loadPosts.bind(this,"next"),lastPage:Math.ceil(this.state.totalPosts/2),currentPage:this.state.postPage},this.state.posts.map(function(e){return o.a.createElement(J,{key:e._id,id:e._id,author:e.creator,date:new Date(e.createdAt).toLocaleDateString("en-US"),title:e.title,image:e.imageUrl,content:e.content,taken_date:e.taken_date,location:e.location,ISO:e.ISO,shutter_speed:e.shutter_speed,aperture:e.aperture,camera:e.camera,lens:e.lens,equipment:e.equipment,edit_soft:e.edit_soft,user_rate:e.user_rate,onStartEdit:t.startEditPostHandler.bind(t,e._id),onDelete:t.deletePostHandler.bind(t,e._id),onBucket:t.bucketPostHandler.bind(t,e._id),offBucket:t.bucketRemoveHandler.bind(t,e._id),userBucket:t.state.bucket,token:t.props.token,startReview:t.startReviewHandler.bind(t,e._id)})}))))}}]),e}(n.Component)),St=(a(362),a(381)),Ct=a(382),Pt=function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).state={viewport:{width:650,height:350,latitude:a.props.value[1],longitude:a.props.value[0],zoom:8}},a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this;return this.props.viewMap?o.a.createElement(T,{title:"View Location",acceptEnabled:!0,onCancelModal:this.props.cancelViewMap,onAcceptModal:this.props.cancelViewMap,isLoading:!1},o.a.createElement(et.c,Object.assign({},this.state.viewport,{onViewportChange:function(e){return t.setState({viewport:e})},mapboxApiAccessToken:"pk.eyJ1IjoieTI2MmhhbiIsImEiOiJjanozamU2bmkwMzJ5M2d0Nm84ZW5meHhzIn0.L1kW4Q7vNyX0fCJJEYI5PA",mapStyle:"mapbox://styles/y262han/cjz3kx9a80fby1cr3d8oydttt",width:"450px",height:"400px"}))):null}}]),e}(n.Component),_t=a(255),jt=a(388),Ot=function(t){var e=o.a.useState(!0),a=Object(_t.a)(e,2),n=a[0],s=a[1];return o.a.createElement(jt.a,{onClose:function(){return s(!n)},show:n,animation:!1},o.a.createElement(jt.a.Header,null,o.a.createElement("strong",{className:"mr-auto"},t.user),o.a.createElement("small",null,"rating: ",t.rating)),o.a.createElement(jt.a.Body,null,t.comment))},Lt=function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).state={title:"",author:"",date:"",image:"",content:"",taken_date:"",location:"",ISO:"",shutter_speed:"",aperture:"",camera:"",lens:"",equipment:"",edit_soft:"",user_rate:"",loading:"true",public_rate:[{rating:5}],loadComment:1,btnTitle:"Load More",viewMap:!1},a.progressBarColorHandler=function(){return a.state.user_rate>3?"success":a.state.user_rate>1?"warning":"danger"},a.getRateAverage=function(){for(var t=a.state.public_rate,e=0,n=0,o=0;o<t.length;o++)e+=t[o].rating,n+=1;var s=e/n;return Number.isNaN(s)?["None","None","None"]:[20*s,s+"/ 5",s]},a.getAllCommentsHandler=Object(u.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("Load More"!==a.state.btnTitle){t.next=5;break}return t.next=3,a.setState({btnTitle:"Collapse",loadComment:a.state.public_rate.length});case 3:t.next=7;break;case 5:return t.next=7,a.setState({btnTitle:"Load More",loadComment:1});case 7:return t.abrupt("return");case 8:case"end":return t.stop()}},t)})),a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"componentWillMount",value:function(){var t=Object(u.a)(c.a.mark(function t(){var e,a,n,o,s;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.props.match.params.postId,t.prev=1,t.next=4,fetch("https://photography-spot-share.herokuapp.com/feed/post/"+e,{headers:{Authorization:"Bearer "+this.props.token}});case 4:if(200===(a=t.sent).status){t.next=7;break}throw new Error("Failed to fetch status");case 7:return t.next=9,a.json();case 9:return n=t.sent,this.setState({title:n.post.title,author:n.post.creator.name,image:"https://photography-spot-share.herokuapp.com/"+n.post.imageUrl,date:new Date(n.post.createdAt).toLocaleDateString("en-US"),content:n.post.content,taken_date:n.post.taken_date,location:n.post.location,ISO:n.post.ISO,shutter_speed:n.post.shutter_speed,aperture:n.post.aperture,camera:n.post.camera,lens:n.post.lens,equipment:n.post.equipment,edit_soft:n.post.edit_soft,user_rate:n.post.user_rate,loading:"false"}),t.next=13,fetch("https://photography-spot-share.herokuapp.com/feed/rating/"+e,{headers:{Authorization:"Bearer "+this.props.token}});case 13:if(200===(o=t.sent).status){t.next=16;break}throw new Error("Failed to fetch status");case 16:return t.next=18,o.json();case 18:s=t.sent,this.setState({public_rate:s.ratings}),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(1),console.log(t.t0);case 25:case"end":return t.stop()}},t,this,[[1,22]])}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;if("true"===this.state.loading)return o.a.createElement(U,null);var e=JSON.parse(JSON.stringify(this.state.public_rate)),a=this.getRateAverage();return[o.a.createElement("section",{className:"single-post",key:"mainSinglePosts"},o.a.createElement(Pt,{viewMap:this.state.viewMap,text:this.state.location.text,value:this.state.location.center,cancelViewMap:function(){t.setState({viewMap:!1})}}),o.a.createElement("h1",null,this.state.title),o.a.createElement(D.a,{className:"Container"},o.a.createElement("h2",{className:"single-post-center"},"Created by ",this.state.author," on ",this.state.date),o.a.createElement("h2",{className:"single-post-center"},"Shot at ",this.state.location.text," on ",this.state.taken_date)),o.a.createElement("hr",{className:"hr"}),o.a.createElement("div",{style:{padding:"1rem",maxHeight:"40rem"}},o.a.createElement(St.a,{src:this.state.image,fluid:!0,style:{maxHeight:"35rem"}})),o.a.createElement("div",{className:"single-post__info padding"},o.a.createElement("p",null,this.state.content),o.a.createElement("hr",{className:"hr"}),o.a.createElement(ft.a,{striped:!0,bordered:!0,hover:!0},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Parameters"),o.a.createElement("th",null,"Value"),o.a.createElement("th",null,"Equipments"),o.a.createElement("th",null,"Name"))),o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("td",null,"ISO"),o.a.createElement("td",null,this.state.ISO),o.a.createElement("td",null,"Camera"),o.a.createElement("td",null,this.state.camera)),o.a.createElement("tr",null,o.a.createElement("td",null,"Shutter Speed"),o.a.createElement("td",null,this.state.shutter_speed),o.a.createElement("td",null,"Lens"),o.a.createElement("td",null,this.state.lens)),o.a.createElement("tr",null,o.a.createElement("td",null,"Aperture"),o.a.createElement("td",null,this.state.aperture),o.a.createElement("td",null,"Other Equips"),o.a.createElement("td",null,this.state.equipment)),o.a.createElement("tr",null,o.a.createElement("td",null),o.a.createElement("td",null),o.a.createElement("td",null,"Post-Editing Softwares"),o.a.createElement("td",null,this.state.edit_soft)),o.a.createElement("tr",null,o.a.createElement("td",null,"Author Rating"),o.a.createElement("td",null,this.state.user_rate),o.a.createElement("td",{colSpan:"2"},o.a.createElement(Ct.a,{animated:!0,striped:!0,variant:this.progressBarColorHandler(),now:this.state.user_rate/5*100,label:this.state.user_rate+" / 5"}))),o.a.createElement("tr",null,o.a.createElement("td",null,"Public Rating"),o.a.createElement("td",null,a[2]),o.a.createElement("td",{colSpan:"2"},o.a.createElement(Ct.a,{animated:!0,striped:!0,variant:this.progressBarColorHandler(),label:a[1],now:a[0]})))))),o.a.createElement("div",{style:{height:"30px"}}),o.a.createElement(F,{mode:"flat",onClick:function(){t.setState({viewMap:!0})}},"View Map"),o.a.createElement("div",{style:{height:"30px"}}))].concat(Object(_.a)(e.sort(function(t,e){return e.rating-t.rating}).splice(0,Math.min(this.state.public_rate.length,this.state.loadComment)).map(function(t){return o.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingBottom:"2rem"},key:t.user+"'sComment"},o.a.createElement(Ot,{user:t.user,rating:t.rating,comment:t.comment}))})),[o.a.createElement("div",{style:{paddingBottom:"2rem",paddingLeft:"2rem",textAlign:"center"},key:"LoadAllButton"},o.a.createElement(F,{mode:"flat",onClick:this.getAllCommentsHandler},this.state.btnTitle))])}}]),e}(n.Component),Ht=(a(194),function(t){return o.a.createElement("section",{className:"auth-form"},t.children)}),It=a(391),xt=function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).state={loginForm:{email:{value:"",valid:!1,touched:!1,validators:[Y,$]},password:{value:"",valid:!1,touched:!1,validators:[Y,Z({min:5})]},formIsValid:!1}},a.inputChangeHandler=function(t,e){a.setState(function(a){var n=!0,o=!0,s=!1,r=void 0;try{for(var i,l=a.loginForm[t].validators[Symbol.iterator]();!(o=(i=l.next()).done);o=!0){var c=i.value;n=n&&c(e)}}catch(d){s=!0,r=d}finally{try{o||null==l.return||l.return()}finally{if(s)throw r}}var u=Object(R.a)({},a.loginForm,Object(q.a)({},t,Object(R.a)({},a.loginForm[t],{valid:n,value:e}))),p=!0;for(var h in u)p=p&&u[h].valid;return{loginForm:u,formIsValid:p}})},a.inputBlurHandler=function(t){a.setState(function(e){return{loginForm:Object(R.a)({},e.loginForm,Object(q.a)({},t,Object(R.a)({},e.loginForm[t],{touched:!0})))}})},a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this;return o.a.createElement("div",null,o.a.createElement(It.a,{style:{paddingBottom:"2rem"},slide:!0},o.a.createElement(It.a.Item,null,o.a.createElement("img",{className:"d-block w-100",src:"Norway.jpg",alt:"Iceland"}),o.a.createElement(It.a.Caption,null,o.a.createElement("h1",null,"Welcome to SpotShare"),o.a.createElement("p",{style:{fontSize:"120%"}},"Showcase your breathtaking landscape photos"))),o.a.createElement(It.a.Item,null,o.a.createElement("img",{className:"d-block w-100",src:"Aletsch Glacier.jpg",alt:"Norway"}),o.a.createElement(It.a.Caption,null,o.a.createElement("h1",null,"Welcome to SpotShare"),o.a.createElement("p",{style:{fontSize:"120%"}},"Share your favourate locations with others"))),o.a.createElement(It.a.Item,null,o.a.createElement("img",{className:"d-block w-100",src:"French Polynesia.jpg",alt:"Switzerland"}),o.a.createElement(It.a.Caption,null,o.a.createElement("h1",null,"Welcome to SpotShare"),o.a.createElement("p",{style:{fontSize:"120%"}},"Map your own bucket list for photo trips")))),o.a.createElement("div",{style:{paddingBottom:"2rem"}},o.a.createElement(Ht,null,o.a.createElement(W.a,{onSubmit:function(e){return t.props.onLogin(e,{email:t.state.loginForm.email.value,password:t.state.loginForm.password.value})}},o.a.createElement("div",{className:"login_input"},o.a.createElement(G,{id:"email",label:"Email",type:"email",control:"input",onChange:this.inputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"email"),value:this.state.loginForm.email.value,valid:this.state.loginForm.email.valid,touched:this.state.loginForm.email.touched,placeholder:"username@example.ca",className:"login_input"})),o.a.createElement("div",{className:"login_input"},o.a.createElement(G,{id:"password",label:"Password",type:"password",control:"input",onChange:this.inputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"password"),value:this.state.loginForm.password.value,valid:this.state.loginForm.password.valid,touched:this.state.loginForm.password.touched})),o.a.createElement("div",{className:"login_input"},o.a.createElement(F,{design:"raised",type:"submit",loading:this.props.loading},"Login"))))))}}]),e}(n.Component),Nt=function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).state={signupForm:{email:{value:"",valid:!1,touched:!1,validators:[Y,$]},password:{value:"",valid:!1,touched:!1,validators:[Y,Z({min:5})]},name:{value:"",valid:!1,touched:!1,validators:[Y]},formIsValid:!1}},a.inputChangeHandler=function(t,e){a.setState(function(a){var n=!0,o=!0,s=!1,r=void 0;try{for(var i,l=a.signupForm[t].validators[Symbol.iterator]();!(o=(i=l.next()).done);o=!0){var c=i.value;n=n&&c(e)}}catch(d){s=!0,r=d}finally{try{o||null==l.return||l.return()}finally{if(s)throw r}}var u=Object(R.a)({},a.signupForm,Object(q.a)({},t,Object(R.a)({},a.signupForm[t],{valid:n,value:e}))),p=!0;for(var h in u)p=p&&u[h].valid;return{signupForm:u,formIsValid:p}})},a.inputBlurHandler=function(t){a.setState(function(e){return{signupForm:Object(R.a)({},e.signupForm,Object(q.a)({},t,Object(R.a)({},e.signupForm[t],{touched:!0})))}})},a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this;return o.a.createElement("div",null,o.a.createElement(It.a,{style:{paddingBottom:"2rem"}},o.a.createElement(It.a.Item,null,o.a.createElement("img",{className:"d-block w-100",src:"Norway.jpg",alt:"Iceland"}),o.a.createElement(It.a.Caption,null,o.a.createElement("h1",null,"Welcome to SpotShare"),o.a.createElement("p",{style:{fontSize:"120%"}},"Showcase your breathtaking landscape photos"))),o.a.createElement(It.a.Item,null,o.a.createElement("img",{className:"d-block w-100",src:"Aletsch Glacier.jpg",alt:"Norway"}),o.a.createElement(It.a.Caption,null,o.a.createElement("h1",null,"Welcome to SpotShare"),o.a.createElement("p",{style:{fontSize:"120%"}},"Share your favourate locations with others"))),o.a.createElement(It.a.Item,null,o.a.createElement("img",{className:"d-block w-100",src:"French Polynesia.jpg",alt:"Switzerland"}),o.a.createElement(It.a.Caption,null,o.a.createElement("h1",null,"Welcome to SpotShare"),o.a.createElement("p",{style:{fontSize:"120%"}},"Map your own bucket list for photo trips")))),o.a.createElement("div",{style:{paddingBottom:"2rem"}},o.a.createElement(Ht,null,o.a.createElement(W.a,{onSubmit:function(e){return t.props.onSignup(e,t.state)}},o.a.createElement("div",{className:"login_input"},o.a.createElement(G,{id:"email",label:"Email",type:"email",control:"input",onChange:this.inputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"email"),value:this.state.signupForm.email.value,valid:this.state.signupForm.email.valid,touched:this.state.signupForm.email.touched,placeholder:"username@example.ca"}),o.a.createElement(W.a.Text,{className:"text-muted"},"We'll never share your email with anyone else.")),o.a.createElement("div",{className:"login_input"},o.a.createElement(G,{id:"name",label:"Full Name",type:"text",control:"input",onChange:this.inputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"name"),value:this.state.signupForm.name.value,valid:this.state.signupForm.name.valid,touched:this.state.signupForm.name.touched,placeholder:"John Smith"})),o.a.createElement("div",{className:"login_input"},o.a.createElement(G,{id:"password",label:"Password",type:"password",control:"input",onChange:this.inputChangeHandler,onBlur:this.inputBlurHandler.bind(this,"password"),value:this.state.signupForm.password.value,valid:this.state.signupForm.password.valid,touched:this.state.signupForm.password.touched})),o.a.createElement("div",{className:"login_input"},o.a.createElement(F,{design:"raised",type:"submit",loading:this.props.loading},"Signup"))))))}}]),e}(n.Component),Ft=(a(363),function(t){function e(){var t,a;Object(p.a)(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).state={showBackdrop:!1,showMobileNav:!1,isAuth:!1,token:null,userId:null,authLoading:!1,error:null,navState:null},a.mobileNavHandler=function(t){a.setState({showMobileNav:t,showBackdrop:t})},a.backdropClickHandler=function(){a.setState({showBackdrop:!1,showMobileNav:!1,error:null})},a.logoutHandler=Object(u.a)(c.a.mark(function t(){var e;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://photography-spot-share.herokuapp.com/auth/status",{method:"PATCH",headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"},body:JSON.stringify({status:""})});case 3:if(200===(e=t.sent).status||201===e.status){t.next=6;break}throw new Error("Can't update status!");case 6:a.setState({isAuth:!1,token:null,navState:null}),localStorage.clear(),window.location.reload(),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}},t,null,[[0,11]])})),a.loginHandler=function(t,e){t.preventDefault(),localStorage.clear(),a.setState({authLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,password:e.password})}).then(function(t){if(422===t.status)throw new Error("Validation failed.");if(200!==t.status&&201!==t.status)throw console.log("Error!"),new Error("Could not authenticate you!");return t.json()}).then(function(t){localStorage.setItem("token",t.token),localStorage.setItem("userId",t.userId),a.setState({isAuth:!0,token:t.token,authLoading:!1,userId:t.userId});var e=new Date((new Date).getTime()+36e5);localStorage.setItem("expiryDate",e.toISOString()),a.setAutoLogout(36e5)}).catch(function(t){console.log(t),a.setState({isAuth:!1,authLoading:!1,error:t})})},a.signupHandler=function(t,e){t.preventDefault(),a.setState({authLoading:!0}),fetch("https://photography-spot-share.herokuapp.com/auth/signup",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.signupForm.email.value,password:e.signupForm.password.value,name:e.signupForm.name.value})}).then(function(t){if(422===t.status)throw new Error("Validation failed. Make sure the email address isn't used yet!");if(200!==t.status&&201!==t.status)throw console.log("Error!"),new Error("Creating a user failed!");return t.json()}).then(function(t){a.setState({isAuth:!1,authLoading:!1}),a.props.history.replace("/")}).catch(function(t){console.log(t),a.setState({isAuth:!1,authLoading:!1,error:t})})},a.setAutoLogout=function(t){setTimeout(function(){a.logoutHandler()},t)},a.errorHandler=function(){a.setState({error:null})},a}return Object(g.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){var t=localStorage.getItem("token"),e=localStorage.getItem("expiryDate");if(t&&e)if(new Date(e)<=new Date)this.logoutHandler();else{var a=localStorage.getItem("userId"),n=new Date(e).getTime()-(new Date).getTime();this.setState({isAuth:!0,token:t,userId:a}),this.setAutoLogout(n)}}},{key:"render",value:function(){var t=this,e=o.a.createElement(f.a,null,o.a.createElement(v.a,{path:"/",exact:!0,render:function(e){return o.a.createElement(xt,Object.assign({},e,{onLogin:t.loginHandler,loading:t.state.authLoading}))}}),o.a.createElement(v.a,{path:"/signup",exact:!0,render:function(e){return o.a.createElement(Nt,Object.assign({},e,{onSignup:t.signupHandler,loading:t.state.authLoading}))}}),")} />",o.a.createElement(E.a,{to:"/"}));return this.state.isAuth&&(e=o.a.createElement(f.a,null,o.a.createElement(v.a,{path:"/posts",exact:!0,render:function(e){return o.a.createElement(gt,{userId:t.state.userId,token:t.state.token})}}),o.a.createElement(v.a,{path:"/my-bucket",exact:!0,render:function(e){return o.a.createElement(yt,{userId:t.state.userId,token:t.state.token})}}),o.a.createElement(v.a,{path:"/my-map",exact:!0,render:function(e){return o.a.createElement(kt,{userId:t.state.userId,token:t.state.token})}}),o.a.createElement(v.a,{path:"/rankings",exact:!0,render:function(e){return o.a.createElement(vt,{userId:t.state.userId,token:t.state.token})}}),o.a.createElement(v.a,{path:"/",exact:!0,render:function(e){return o.a.createElement(mt,{userId:t.state.userId,token:t.state.token})}}),o.a.createElement(v.a,{path:"/:postId",render:function(e){return o.a.createElement(Lt,Object.assign({},e,{userId:t.state.userId,token:t.state.token}))}}),o.a.createElement(E.a,{to:"/"}))),o.a.createElement(n.Fragment,null,this.state.showBackdrop&&o.a.createElement(k,{onClick:this.backdropClickHandler}),o.a.createElement(B,{error:this.state.error,onHandle:this.errorHandler}),o.a.createElement(w,{header:o.a.createElement(y,null,o.a.createElement(H,{onOpenMobileNav:this.mobileNavHandler.bind(this,!0),onLogout:this.logoutHandler,isAuth:this.state.isAuth,isLoading:this.state.authLoading,userId:this.state.userId,token:this.state.token,state:this.state.navState})),mobileNav:o.a.createElement(I,{open:this.state.showMobileNav,mobile:!0,onChooseItem:this.mobileNavHandler.bind(this,!1),onLogout:this.logoutHandler,isAuth:this.state.isAuth,isLoading:this.state.authLoading,userId:this.state.userId,token:this.state.token})}),e)}}]),e}(n.Component)),At=Object(b.a)(Ft);r.a.render(o.a.createElement(i.a,null,o.a.createElement(At,null)),document.getElementById("root"))}},[[275,1,2]]]);
//# sourceMappingURL=main.ab462fac.chunk.js.map